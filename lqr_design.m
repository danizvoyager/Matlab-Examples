I_xx=0.01;
I_yy=0.01;
I_zz=0.01;
g=9.81;
m=0.5;
d=0.5;
dt=0.01;
a1=0.5;a2=0.5;a3=0.5;
A=[0  1  0  0    0   0    0   0   0   0   0  0;
   0  a1 0  0    0   0    0   0   0   0   0  0;
   0  0  0  1    0   0    0   0   0   0   0  0;
   0  0  0  a2   0   0    0   0   0   0   0  0;
   0  0  0  0    0   1    0   0   0   0   0  0;
   0  0  0  0    0   a3   0   0   0   0   0  0;
   0  0  0  0    0   0    0   1   0   0   0  0;
   0  0  0  0    0   0    0   0   0   0   0  0;
   0  0  0  0    0   0    0   0   0   1   0  0;
   0  0  0  0    0   0    0   0   0   0   0  0;
   0  0  0  0    0   0    0   0   0   0   0  1;
   0  0  0  0    0   0    0   0   0   0   0  0];

B0=   [0     0     0     0;
       0     0     0     0;
       0     0     0     0;
       0     0     0     0;
       0     0     0     0;
      1/m    0     0     0; 
       0     0     0     0;
       0   d/I_xx  0     0;
       0     0     0     0;
       0     0    d/I_yy 0;
       0     0     0     0;
       0     0     0    d/I_zz];
B1=   [0     0    0    0;
       0     0    0    0;
       0     0    0    0;
       0     0    0    0;
       0     0    0    0;
       g     0    0    0;
       0     0    0    0;
       0     0    0    0;
       0     0    0    0;
       0     0    0    0;
       0     0    0    0;
       0     0    0    0];
   B=B0-B1;
C=[1 0 0 0 0 0 0 0 0 0 0 0;
   0 0 1 0 0 0 0 0 0 0 0 0;
   0 0 0 0 1 0 0 0 0 0 0 0;
   0 0 0 0 0 0 1 0 0 0 0 0;
   0 0 0 0 0 0 0 0 1 0 0 0;
   0 0 0 0 0 0 0 0 0 0 1 0 ];
D=[0 0 0 0;
   0 0 0 0;
   0 0 0 0;
   0 0 0 0;
   0 0 0 0;
   0 0 0 0];
e=eig(A);
Co = ctrb(A,B);
r=rank(Co)
sys_ss=ss(A,B,C,D);
Q=500*(C'*C);
% Q(1,1)=5000;
% Q(3,3)=5000;
% Q(5,5)=5000;
% Q(7,7)=5000;
% Q(9,9)=5000;
% Q(11,11)=5000;
R=0.2*eye(4);
K= lqr(sys_ss,Q,R);